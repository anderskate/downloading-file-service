# Микросервис для скачивания файлов

Микросервис помогает работе основного сайта, сделанного на CMS и обслуживает
запросы на скачивание архивов с файлами. Микросервис не умеет ничего, кроме упаковки файлов
в архив. Закачиваются файлы на сервер через FTP или админку CMS.

Создание архива происходит на лету по запросу от пользователя. Архив не сохраняется на диске, вместо этого по мере упаковки он сразу отправляется пользователю на скачивание.

От неавторизованного доступа архив защищен хешом в адресе ссылки на скачивание, например: `http://host.ru/archive/3bea29ccabbbf64bdebcc055319c5745/`. Хеш задается названием каталога с файлами, выглядит структура каталога так:

```
- photos
    - 3bea29ccabbbf64bdebcc055319c5745
      - 1.jpg
      - 2.jpg
      - 3.jpg
    - af1ad8c76fda2e48ea9aed2937e972ea
      - 1.jpg
      - 2.jpg
```


## Как установить и запустить локально

Для работы микросервиса нужен Python версии не ниже 3.6

Установите необходимые зависимости
```bash
pip install -r requirements.txt
```

Запустите сервер локально
```bash
python server.py
```

Для просмотра дополнительных параметров, введите следующую команду
```bash
python server.py --help
```

```bash
optional arguments:
  -h, --help     show this help message and exit
  --log          Activate logging
  --delay DELAY  Activate delay for response
  --dir DIR      Photo archive directory
```


## Установка и запуск с помощью Docker compose

```bash
docker-compose up
```

Сервер запустится на порту 8080, чтобы проверить его работу перейдите в браузере на страницу [http://0.0.0.0:8080/](http://0.0.0.0:8080/).

# Цели проекта

Код написан в учебных целях — это урок в курсе по Python и веб-разработке на сайте [Devman](https://dvmn.org).